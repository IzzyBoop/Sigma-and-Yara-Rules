title: Suspicious curl Usage Masquerading as Windows on macOS
id: 7a1e5c3b-1c4b-4f82-b8ef-bfa6e11b54a2
description: Detects curl commands on macOS that use fake Windows user-agents or headers, indicating possible data exfiltration or evasion attempts.
status: experimental
author: Izzy
date: 2025/10/21
logsource:
  product: macos
  category: process_creation
detection:
  selection_curl:
    - Image|endswith: '/curl'
    - CommandLine|contains: 'curl'
  selection_headers:
    CommandLine|contains:
      - '--user-agent'
      - '-A'
      - '-H'
  selection_windows_keywords:
    CommandLine|contains:
      - 'Windows'
      - 'Win64'
  condition: selection_curl and selection_headers and selection_windows_keywords
level: medium
